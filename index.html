<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <title>Turneringsbracket</title>
  <style>
    body {
      background-color: #111;
      color: white;
      font-family: Arial, sans-serif;
    }
    .bracket {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 40px;
      padding: 40px;
      justify-items: center;
    }
    .match {
      background: #222;
      padding: 10px 20px;
      border-radius: 10px;
      text-align: center;
      width: 220px;
    }
    .team {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 8px 0;
    }
    .team img {
      width: 30px;
      height: 30px;
      margin-right: 10px;
      object-fit: contain;
    }
    .score {
      font-size: 14px;
      color: #aaa;
    }
  </style>
</head>
<body>
  <div class="bracket" id="bracket"></div>

  <script>
    const SHEET_ID = "1Fjlv7GXe2eU0oFRJC3ubNhuxnYa0KIFgngrqlUcA5lY";
    const BRACKET_SHEET = "BracketData";
    const LOGO_SHEET = "Logotabell";

    async function fetchSheet(sheetName) {
      const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${sheetName}`;
      const response = await fetch(url);
      const text = await response.text();
      const json = JSON.parse(text.substr(47).slice(0, -2));
      const cols = json.table.cols.map(col => col.label);
      return json.table.rows.map(row => {
        const obj = {};
        row.c.forEach((cell, i) => {
          obj[cols[i]] = cell ? cell.v : "";
        });
        return obj;
      });
    }

    async function init() {
      const logos = await fetchSheet(LOGO_SHEET);
      const logoMap = {};
      logos.forEach(row => {
        logoMap[row["Lag"]] = row["LÃ¤nk"];
      });

      const matches = await fetchSheet(BRACKET_SHEET);
      const bracketDiv = document.getElementById("bracket");
      matches.forEach(match => {
        const matchDiv = document.createElement("div");
        matchDiv.className = "match";

        const teamA = document.createElement("div");
        teamA.className = "team";
        const logoA = document.createElement("img");
        logoA.src = logoMap[match["Lag A"]] || "";
        const nameA = document.createElement("span");
        nameA.textContent = match["Lag A"];
        teamA.appendChild(logoA);
        teamA.appendChild(nameA);

        const scoreA = document.createElement("div");
        scoreA.className = "score";
        scoreA.textContent = `Score: ${match["Score A"]}`;

        const teamB = document.createElement("div");
        teamB.className = "team";
        const logoB = document.createElement("img");
        logoB.src = logoMap[match["Lag B"]] || "";
        const nameB = document.createElement("span");
        nameB.textContent = match["Lag B"];
        teamB.appendChild(logoB);
        teamB.appendChild(nameB);

        const scoreB = document.createElement("div");
        scoreB.className = "score";
        scoreB.textContent = `Score: ${match["Score B"]}`;

        matchDiv.appendChild(teamA);
        matchDiv.appendChild(scoreA);
        matchDiv.appendChild(teamB);
        matchDiv.appendChild(scoreB);

        bracketDiv.appendChild(matchDiv);
      });
    }

    init();
  </script>
</body>
</html>
